#!/usr/bin/env python

#./crawl_certificates.py -r 211.45.27.128/20 -p 443 -t 4 -m 256 2> /devnull

# https://ip-ranges.amazonaws.com/ip-ranges.json
# cat amazon_ips.txt | xargs -i ./crawl_certificates.py -r {} -p 443 -t 4 -m 256 2> /devnull
# cat amazon_ips.txt | xargs -i ./CrawlCert.py -r {} -p 443 -t 0.5 -m 256 2> /dev/null > Amazon_CertList_170909_2223.txt
# for ips in `cat ./amazon_ips.txt`; do echo $ips; ./CrawlCert.py -r $ips -p 443 -t 0.5 -m 256 2> /dev/null > Amazon_CertList_170909_2223.txt; done
# for ips in `cat ./amazon_ips.txt`; do echo $ips; ./CrawlCert.py -r $ips -p 443 -t 1 -m 256 2> /dev/null > Amazon_CertList_170909_2223_`echo $ips | sed 's/\//_/'`.txt; done


from multiprocessing import Process, Queue, Lock
from Queue import Empty as QueueEmpty
import requests
import os
import sys
import argparse
import socket
import ssl
import errno
import time
import argparse
import iptools
import random
import OpenSSL
import signal

Max_Do_Process_Cnt = 256
Max_Log_Process_Cnt = 5
G_TimeOut = 1.0

Process_FileWrite_Mutex = Lock()


class Unbuffered(object):
   def __init__(self, stream):
       self.stream = stream
   def write(self, data):
       self.stream.write(data)
       self.stream.flush()
   def writelines(self, datas):
       self.stream.writelines(datas)
       self.stream.flush()
   def __getattr__(self, attr):
       return getattr(self.stream, attr)

def cert_check(ip_addr, timeout, port):    
#>>> dir(x509)
# ['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_get_boundary_time', '_get_name', '_set_boundary_time', '_set_name', '_x509', 'add_extensions', 'digest', 'get_extension', 'get_extension_count', 'get_issuer', 'get_notAfter', 'get_notBefore', 'get_pubkey', 'get_serial_number', 'get_signature_algorithm', 'get_subject', 'get_version', 'gmtime_adj_notAfter', 'gmtime_adj_notBefore', 'has_expired', 'set_issuer', 'set_notAfter', 'set_notBefore', 'set_pubkey', 'set_serial_number', 'set_subject', 'set_version', 'sign', 'subject_name_hash']
# >>> x509.get_issuer()
# <X509Name object '/C=TW/ST=Taiwan/L=Taipei/O=Synology Inc./OU=Certificate Authority/CN=Synology Inc. CA/emailAddress=product@synology.com'>
# >>> x509.get_subject()
# <X509Name object '/C=TW/ST=Taiwan/L=Taipei/O=Synology Inc./OU=FTP Team/CN=synology.com/emailAddress=product@synology.com'>

    socket.setdefaulttimeout(timeout)
    try:
        print ("Doing " + ip_addr)
        cert = ssl.get_server_certificate((str(ip_addr), port))
        x509 = OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_PEM, cert)
        #der = OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_ASN1, x509)
        #ssl.PEM_cert_to_DER_cert(x509)
        #cert_name = x509.get_subject().get_components()[-1][-1] #get CN pair, then CN value
        #cert_name = x509.get_issuer().__str__()
        cert_name = x509.get_issuer().__str__() + ' [[*]] ' + x509.get_subject().__str__()
        return '['+str(ip_addr) + ']  ' + cert_name
    except socket.error, out:
        errorcode = out[0]
        if errorcode is None:                   #possibly down
            return '['+str(ip_addr) + '] ' + 'possibly down'
        if errorcode == errno.EPERM:            #unsupported protocol
            return '['+str(ip_addr) + '] ' + 'Unsupported protocol'
        if errorcode == errno.ECONNREFUSED:     #closed on port
            return '['+str(ip_addr) + '] ' + 'Connect refused'
        if errorcode == 'timed out':            #timed out, probably down.
            return '['+str(ip_addr) + '] ' + 'timed out, probably down'
    return '[' + str(ip_addr) + '] ' + '### What is this??? ###'

def Do_ProcessA(recv_data, timeout, port):    
    cert_res = cert_check(recv_data, float(timeout), port)    
    send_data = cert_res
    return send_data

def Do_ProcessB(recv_data):
    # print (recv_data)
    recv_data = recv_data.replace('X509Name object ', '')
    # print (recv_data)
    with Process_FileWrite_Mutex:
        if('probably down'.lower() not in recv_data.lower() and 
            'Connect refused'.lower() not in recv_data.lower() and             
            'What is this'.lower() not in recv_data.lower() and             
            'Unsupported protocol'.lower() not in recv_data.lower()):
                if ('uber.com' in recv_data.lower()):
                    print (recv_data)

                # if('vmware horizon view' in recv_data.lower() or 
                #     'samsung'.lower() in recv_data.lower() or 
                #     'ssowslp'.lower() in recv_data.lower() or  # samsung fire
                #     'opic'.lower() in recv_data.lower() or  # opic
                #     'sds'.lower() in recv_data.lower() or 
                #     ('sec'.lower() in recv_data.lower() and 'secu'.lower() not in recv_data.lower())):
                #     print (recv_data + '  #@#@#@#@#')
                else:
                    # print (recv_data)
                    pass
    return recv_data

def processA(queueA, queueB, timeout, port):
    while True:
        try:
            recv_data = queueA.get_nowait()
            if recv_data == '__END__':
                break
        except QueueEmpty:
            time.sleep(0.5)
            continue

        send_data = Do_ProcessA(recv_data, timeout, port)
        queueB.put(send_data)

def processB(queueB, _):
    while True:
        try:
            recv_data = queueB.get_nowait()
            if recv_data == '__END__':
                break
        except QueueEmpty:
            time.sleep(1)
            continue

        send_data = Do_ProcessB(recv_data)
        #print (send_data)

def start_procs(num_workers, target_function, args):
    procs = []
    for _ in range(num_workers):
        p = Process(target=target_function, args=args)
        p.start()
        procs.append(p)
    return procs

def shutdown_process(proc_lst, queue):
    for _ in proc_lst:
        queue.put('__END__')
    for p in proc_lst:
        try:
            p.join()
        except KeyboardInterrupt:
            break

def Usage():
    print ('Usage: ' + sys.argv[0] + ' -s 1.1.1.1 -e 1.1.1.254 -p 443 -t 0.5')
    print ('       ' + sys.argv[0] + ' -r 1.1/16 -p 443 -t 0.5')
    print ('')

def main():
    print ('\nFor finding SSL/TLS certificates in a IP range.\n')
    PARSER = argparse.ArgumentParser(description="""This program scans a range of IPs and attempts
    to read hostname information from the SSL/TLS certificates""")
    PARSER.add_argument('-r', '--range', help='IP range(ex:1.1/16,1.1.1/24)', required=False)    
    PARSER.add_argument('-s', '--start', help='IP or start of IP range', required=False)
    PARSER.add_argument('-e', '--end', help='End of IP range', required=False)
    PARSER.add_argument('-t', '--timeout', help='Socket timeout (default:2)', required=False)
    PARSER.add_argument('-p', '--port', help='SSL/TLS port (default:443)', required=False)
    PARSER.add_argument('-m', '--maxscanprocess', help='SSL/TLS port (default:443)', required=False)
    ARGS = PARSER.parse_args()

    # if ARGS.range is None:
    #     if ARGS.start is None:
    #         Usage()
    #         sys.exit(2)
    if ARGS.range is not None and ARGS.start is not None:
        print ('The start address of IP and IP range cannot be used concurrently.')
        print ('')
        Usage()
        sys.exit(2)

    # if ARGS.range is not None:
    #     IPLIST = iptools.IpRange(ARGS.range)
    # # else:
    # #     if ARGS.end is None:
    # #         ARGS.end = ARGS.start
    # #     IPLIST = iptools.IpRange(ARGS.start, ARGS.end)
    # Amazon_IPs_List = prefixes()
    # RemoveDup_Amazon_IPs_List = list(set(Amazon_IPs_List))
    # RemoveDup_Amazon_IPs_List.sort()





    if ARGS.maxscanprocess is None:
        Max_Do_Process_Cnt = 200
        Max_Log_Process_Cnt = 2
    else:
        if(int(ARGS.maxscanprocess) > 1024):
            Max_Do_Process_Cnt = 1024
        else:
            Max_Do_Process_Cnt = int(ARGS.maxscanprocess)

        if(Max_Do_Process_Cnt / 50 <= 4):
            Max_Log_Process_Cnt = 4
        else:
            Max_Log_Process_Cnt = Max_Do_Process_Cnt / 50

    if ARGS.timeout is None:
        ARGS.timeout = 1
    if ARGS.port is None:
        ARGS.port = 443

    sys.stdout = Unbuffered(sys.stdout)

    queueA = Queue(2048) #needs to be a bit bigger than actual. 3x works well for me
    queueB = Queue(2048)

    procsA = start_procs(Max_Do_Process_Cnt, processA, (queueA, queueB, ARGS.timeout, ARGS.port)) 
    procsB = start_procs(Max_Log_Process_Cnt, processB, (queueB, None))  

    IPV4 = "8.35.192.0/21"
    IPLIST = iptools.IpRange(IPV4)
    for ip_addr in IPLIST:
        queueA.put(ip_addr)
        print (ip_addr)


    # for IPv4_Class in RemoveDup_Amazon_IPs_List:
    #  	IPLIST = iptools.IpRange(IPv4_Class)
    #     print (IPv4_Class)
    #     [queueA.put(ip_addrs) for ip_addrs in IPLIST]
    #     # print ("[+] NEXT" + ip_addrs)



    # scan_start = IPLIST.__getitem__(0)
    # scan_end = IPLIST.__getitem__(IPLIST.__len__()-1)
    # print "\nScanning %s IPs from %s to %s...\n" % (len(IPLIST), scan_start, scan_end)
    # print 'Scan Process Nums : ' + str(Max_Do_Process_Cnt) + ', Log Proc Nums : ' + str(Max_Log_Process_Cnt)
    # print ''



    

    shutdown_process(procsA, queueA)
    shutdown_process(procsB, queueB)
 
if __name__ == "__main__":
    main()


"""
13.32.0.0/15
13.52.0.0/16
13.54.0.0/15
13.56.0.0/16
13.57.0.0/16
13.58.0.0/15
13.112.0.0/14
13.124.0.0/16
13.125.0.0/16
13.126.0.0/15
13.209.0.0/16
13.210.0.0/15
13.228.0.0/15
13.230.0.0/15
13.232.0.0/14
13.236.0.0/14
13.250.0.0/15
18.194.0.0/15
18.196.0.0/15
18.200.0.0/16
18.216.0.0/14
18.220.0.0/14
18.231.0.0/16
23.20.0.0/14
27.0.0.0/22
34.192.0.0/12
34.208.0.0/12
34.224.0.0/12
34.240.0.0/13
34.248.0.0/13
35.153.0.0/16
35.154.0.0/16
35.155.0.0/16
35.156.0.0/14
35.160.0.0/13
35.168.0.0/13
35.176.0.0/15
35.178.0.0/15
35.180.0.0/15
35.182.0.0/15
43.250.192.0/24
43.250.193.0/24
46.51.128.0/18
46.51.192.0/20
46.51.216.0/21
46.51.224.0/19
46.137.0.0/17
46.137.128.0/18
46.137.192.0/19
46.137.224.0/19
50.16.0.0/15
50.18.0.0/16
50.19.0.0/16
50.112.0.0/16
52.0.0.0/15
52.2.0.0/15
52.4.0.0/14
52.8.0.0/16
52.9.0.0/16
52.10.0.0/15
52.12.0.0/15
52.14.0.0/16
52.15.0.0/16
52.16.0.0/15
52.18.0.0/15
52.20.0.0/14
52.24.0.0/14
52.28.0.0/16
52.29.0.0/16
52.30.0.0/15
52.32.0.0/14
52.36.0.0/14
52.40.0.0/14
52.44.0.0/15
52.46.0.0/18
52.46.64.0/20
52.46.80.0/21
52.46.88.0/22
52.46.92.0/22
52.47.0.0/16
52.48.0.0/14
52.52.0.0/15
52.54.0.0/15
52.56.0.0/16
52.57.0.0/16
52.58.0.0/15
52.60.0.0/16
52.61.0.0/16
52.62.0.0/15
52.64.0.0/17
52.64.128.0/17
52.65.0.0/16
52.66.0.0/16
52.67.0.0/16
52.68.0.0/15
52.70.0.0/15
52.72.0.0/15
52.74.0.0/16
52.75.0.0/16
52.76.0.0/17
52.76.128.0/17
52.77.0.0/16
52.78.0.0/16
52.79.0.0/16
52.80.0.0/16
52.81.0.0/16
52.82.187.0/24
52.82.188.0/22
52.82.192.0/18
52.83.0.0/16
52.84.0.0/15
52.86.0.0/15
52.88.0.0/15
52.90.0.0/15
52.92.0.0/20
52.92.16.0/20
52.92.32.0/22
52.92.39.0/24
52.92.40.0/21
52.92.48.0/22
52.92.52.0/22
52.92.56.0/22
52.92.60.0/22
52.92.64.0/22
52.92.68.0/22
52.92.72.0/22
52.92.76.0/22
52.92.80.0/22
52.92.84.0/22
52.92.88.0/22
52.92.248.0/22
52.92.252.0/22
52.93.0.0/24
52.93.1.0/24
52.93.2.0/24
52.93.3.0/24
52.93.4.0/24
52.93.5.0/24
52.93.8.0/22
52.93.16.0/24
52.94.0.0/22
52.94.4.0/24
52.94.5.0/24
52.94.6.0/24
52.94.7.0/24
52.94.8.0/24
52.94.9.0/24
52.94.10.0/24
52.94.11.0/24
52.94.12.0/24
52.94.13.0/24
52.94.14.0/24
52.94.15.0/24
52.94.16.0/24
52.94.17.0/24
52.94.20.0/24
52.94.24.0/23
52.94.26.0/23
52.94.28.0/23
52.94.30.0/23
52.94.32.0/20
52.94.48.0/20
52.94.64.0/22
52.94.72.0/22
52.94.80.0/20
52.94.96.0/20
52.94.112.0/22
52.94.192.0/22
52.94.196.0/24
52.94.197.0/24
52.94.198.0/28
52.94.198.16/28
52.94.198.32/28
52.94.198.48/28
52.94.198.64/28
52.94.198.80/28
52.94.198.96/28
52.94.198.112/28
52.94.198.128/28
52.94.198.144/28
52.94.199.0/24
52.94.200.0/24
52.94.204.0/23
52.94.206.0/23
52.94.208.0/21
52.94.216.0/21
52.94.224.0/20
52.94.240.0/22
52.94.244.0/22
52.94.248.0/28
52.94.248.16/28
52.94.248.32/28
52.94.248.48/28
52.94.248.64/28
52.94.248.80/28
52.94.248.96/28
52.94.248.112/28
52.94.248.128/28
52.94.248.144/28
52.94.248.160/28
52.94.248.176/28
52.94.248.192/28
52.94.248.208/28
52.94.248.224/28
52.94.249.0/28
52.94.249.16/28
52.94.249.32/28
52.94.249.64/28
52.94.249.80/28
52.94.252.0/23
52.94.254.0/23
52.95.0.0/20
52.95.16.0/21
52.95.24.0/22
52.95.28.0/24
52.95.30.0/23
52.95.34.0/24
52.95.35.0/24
52.95.36.0/22
52.95.40.0/24
52.95.48.0/22
52.95.56.0/22
52.95.60.0/24
52.95.61.0/24
52.95.62.0/24
52.95.63.0/24
52.95.64.0/20
52.95.80.0/20
52.95.96.0/22
52.95.100.0/22
52.95.104.0/22
52.95.108.0/23
52.95.110.0/24
52.95.111.0/24
52.95.112.0/20
52.95.128.0/21
52.95.136.0/23
52.95.138.0/24
52.95.142.0/23
52.95.144.0/24
52.95.145.0/24
52.95.146.0/23
52.95.148.0/23
52.95.150.0/24
52.95.154.0/23
52.95.156.0/24
52.95.192.0/20
52.95.212.0/22
52.95.240.0/24
52.95.241.0/24
52.95.242.0/24
52.95.243.0/24
52.95.244.0/24
52.95.245.0/24
52.95.246.0/24
52.95.247.0/24
52.95.248.0/24
52.95.249.0/24
52.95.250.0/24
52.95.251.0/24
52.95.252.0/24
52.95.253.0/24
52.95.254.0/24
52.95.255.0/28
52.95.255.16/28
52.95.255.32/28
52.95.255.48/28
52.95.255.64/28
52.95.255.80/28
52.95.255.96/28
52.95.255.112/28
52.95.255.128/28
52.95.255.144/28
52.119.160.0/20
52.119.176.0/21
52.119.184.0/22
52.119.188.0/22
52.119.192.0/22
52.119.196.0/22
52.119.206.0/23
52.119.208.0/23
52.119.210.0/23
52.119.212.0/23
52.119.214.0/23
52.119.216.0/21
52.119.224.0/21
52.119.232.0/21
52.192.0.0/15
52.196.0.0/14
52.200.0.0/13
52.208.0.0/13
52.216.0.0/15
52.218.0.0/17
52.218.128.0/17
52.219.0.0/20
52.219.16.0/22
52.219.20.0/22
52.219.24.0/21
52.219.32.0/21
52.219.40.0/22
52.219.44.0/22
52.219.56.0/22
52.219.60.0/23
52.219.62.0/23
52.219.64.0/22
52.219.68.0/22
52.219.72.0/22
52.219.76.0/22
52.219.80.0/20
52.220.0.0/15
52.222.0.0/17
52.222.128.0/17
54.64.0.0/15
54.66.0.0/16
54.67.0.0/16
54.68.0.0/14
54.72.0.0/15
54.74.0.0/15
54.76.0.0/15
54.78.0.0/16
54.79.0.0/16
54.80.0.0/13
54.88.0.0/14
54.92.0.0/17
54.92.128.0/17
54.93.0.0/16
54.94.0.0/16
54.95.0.0/16
54.144.0.0/14
54.148.0.0/15
54.150.0.0/16
54.151.0.0/17
54.151.128.0/17
54.152.0.0/16
54.153.0.0/17
54.153.128.0/17
54.154.0.0/16
54.155.0.0/16
54.156.0.0/14
54.160.0.0/13
54.168.0.0/16
54.169.0.0/16
54.170.0.0/15
54.172.0.0/15
54.174.0.0/15
54.176.0.0/15
54.178.0.0/16
54.179.0.0/16
54.182.0.0/16
54.183.0.0/16
54.184.0.0/13
54.192.0.0/16
54.193.0.0/16
54.194.0.0/15
54.196.0.0/15
54.198.0.0/16
54.199.0.0/16
54.200.0.0/15
54.202.0.0/15
54.204.0.0/15
54.206.0.0/16
54.207.0.0/16
54.208.0.0/15
54.210.0.0/15
54.212.0.0/15
54.214.0.0/16
54.215.0.0/16
54.216.0.0/15
54.218.0.0/16
54.219.0.0/16
54.220.0.0/16
54.221.0.0/16
54.222.0.0/19
54.222.48.0/22
54.222.57.0/24
54.222.58.0/28
54.222.128.0/17
54.223.0.0/16
54.224.0.0/15
54.226.0.0/15
54.228.0.0/16
54.229.0.0/16
54.230.0.0/16
54.231.0.0/17
54.231.128.0/19
54.231.160.0/19
54.231.192.0/20
54.231.224.0/21
54.231.232.0/21
54.231.240.0/22
54.231.244.0/22
54.231.248.0/22
54.231.252.0/24
54.231.253.0/24
54.232.0.0/16
54.233.0.0/18
54.233.64.0/18
54.233.128.0/17
54.234.0.0/15
54.236.0.0/15
54.238.0.0/16
54.239.0.0/28
54.239.0.16/28
54.239.0.32/28
54.239.0.48/28
54.239.0.64/28
54.239.0.80/28
54.239.0.96/28
54.239.0.112/28
54.239.0.128/28
54.239.0.144/28
54.239.0.160/28
54.239.0.176/28
54.239.0.192/28
54.239.0.208/28
54.239.0.224/28
54.239.0.240/28
54.239.1.0/28
54.239.1.16/28
54.239.2.0/23
54.239.4.0/22
54.239.8.0/21
54.239.16.0/20
54.239.32.0/21
54.239.48.0/22
54.239.52.0/23
54.239.54.0/23
54.239.56.0/21
54.239.96.0/24
54.239.98.0/24
54.239.99.0/24
54.239.100.0/23
54.239.104.0/23
54.239.108.0/22
54.239.116.0/22
54.239.120.0/21
54.239.128.0/18
54.239.192.0/19
54.240.128.0/18
54.240.192.0/22
54.240.196.0/24
54.240.197.0/24
54.240.198.0/24
54.240.199.0/24
54.240.200.0/24
54.240.202.0/24
54.240.203.0/24
54.240.204.0/22
54.240.208.0/22
54.240.212.0/22
54.240.216.0/22
54.240.220.0/22
54.240.225.0/24
54.240.226.0/24
54.240.227.0/24
54.240.228.0/23
54.240.230.0/23
54.240.232.0/22
54.240.244.0/22
54.240.248.0/21
54.241.0.0/16
54.242.0.0/15
54.244.0.0/16
54.245.0.0/16
54.246.0.0/16
54.247.0.0/16
54.248.0.0/15
54.250.0.0/16
54.251.0.0/16
54.252.0.0/16
54.253.0.0/16
54.254.0.0/16
54.255.0.0/16
67.202.0.0/18
72.21.192.0/19
72.44.32.0/19
75.101.128.0/17
79.125.0.0/17
87.238.80.0/21
96.127.0.0/17
103.4.8.0/22
103.4.12.0/22
103.8.172.0/22
103.246.148.0/23
103.246.150.0/23
107.20.0.0/14
122.248.192.0/18
172.96.97.0/24
172.96.98.0/24
174.129.0.0/16
175.41.128.0/18
175.41.192.0/18
176.32.64.0/19
176.32.96.0/21
176.32.104.0/21
176.32.112.0/21
176.32.120.0/22
176.32.125.0/25
176.34.0.0/19
176.34.32.0/19
176.34.64.0/18
176.34.128.0/17
177.71.128.0/17
177.72.240.0/21
178.236.0.0/20
184.72.0.0/18
184.72.64.0/18
184.72.128.0/17
184.73.0.0/16
184.169.128.0/17
185.48.120.0/22
185.143.16.0/24
203.83.220.0/22
204.236.128.0/18
204.236.192.0/18
204.246.160.0/22
204.246.164.0/22
204.246.168.0/22
204.246.174.0/23
204.246.176.0/20
205.251.192.0/19
205.251.224.0/22
205.251.228.0/22
205.251.232.0/22
205.251.236.0/22
205.251.240.0/22
205.251.244.0/23
205.251.247.0/24
205.251.248.0/24
205.251.249.0/24
205.251.250.0/23
205.251.252.0/23
205.251.254.0/24
207.171.160.0/20
207.171.176.0/20
216.137.32.0/19
216.182.224.0/20
54.183.255.128/26
54.228.16.0/26
54.232.40.64/26
54.241.32.64/26
54.243.31.192/26
54.244.52.192/26
54.245.168.0/26
54.248.220.0/26
54.250.253.192/26
54.251.31.128/26
54.252.79.128/26
54.252.254.192/26
54.255.254.192/26
107.23.255.0/26
176.34.159.192/26
177.71.207.128/26
52.82.188.0/22
52.92.0.0/20
52.92.16.0/20
52.92.32.0/22
52.92.39.0/24
52.92.40.0/21
52.92.48.0/22
52.92.52.0/22
52.92.56.0/22
52.92.60.0/22
52.92.64.0/22
52.92.68.0/22
52.92.72.0/22
52.92.76.0/22
52.92.80.0/22
52.92.84.0/22
52.92.88.0/22
52.92.248.0/22
52.92.252.0/22
52.95.128.0/21
52.95.136.0/23
52.95.138.0/24
52.95.142.0/23
52.95.144.0/24
52.95.145.0/24
52.95.146.0/23
52.95.148.0/23
52.95.150.0/24
52.95.154.0/23
52.95.156.0/24
52.216.0.0/15
52.218.0.0/17
52.218.128.0/17
52.219.0.0/20
52.219.16.0/22
52.219.20.0/22
52.219.24.0/21
52.219.32.0/21
52.219.40.0/22
52.219.44.0/22
52.219.56.0/22
52.219.60.0/23
52.219.62.0/23
52.219.64.0/22
52.219.68.0/22
52.219.72.0/22
52.219.76.0/22
52.219.80.0/20
54.222.20.0/22
54.222.48.0/22
54.231.0.0/17
54.231.128.0/19
54.231.160.0/19
54.231.192.0/20
54.231.224.0/21
54.231.232.0/21
54.231.240.0/22
54.231.248.0/22
54.231.252.0/24
54.231.253.0/24
13.52.0.0/16
13.54.0.0/15
13.56.0.0/16
13.57.0.0/16
13.58.0.0/15
13.112.0.0/14
13.124.0.0/16
13.125.0.0/16
13.126.0.0/15
13.209.0.0/16
13.210.0.0/15
13.228.0.0/15
13.230.0.0/15
13.232.0.0/14
13.236.0.0/14
13.250.0.0/15
18.194.0.0/15
18.196.0.0/15
18.200.0.0/16
18.216.0.0/14
18.220.0.0/14
18.231.0.0/16
23.20.0.0/14
34.192.0.0/12
34.208.0.0/12
34.224.0.0/12
34.240.0.0/13
34.248.0.0/13
35.153.0.0/16
35.154.0.0/16
35.155.0.0/16
35.156.0.0/14
35.160.0.0/13
35.168.0.0/13
35.176.0.0/15
35.178.0.0/15
35.180.0.0/15
35.182.0.0/15
46.51.128.0/18
46.51.192.0/20
46.51.216.0/21
46.51.224.0/19
46.137.0.0/17
46.137.128.0/18
46.137.192.0/19
46.137.224.0/19
50.16.0.0/15
50.18.0.0/16
50.19.0.0/16
50.112.0.0/16
52.0.0.0/15
52.2.0.0/15
52.4.0.0/14
52.8.0.0/16
52.9.0.0/16
52.10.0.0/15
52.12.0.0/15
52.14.0.0/16
52.15.0.0/16
52.16.0.0/15
52.18.0.0/15
52.20.0.0/14
52.24.0.0/14
52.28.0.0/16
52.29.0.0/16
52.30.0.0/15
52.32.0.0/14
52.36.0.0/14
52.40.0.0/14
52.44.0.0/15
52.47.0.0/16
52.48.0.0/14
52.52.0.0/15
52.54.0.0/15
52.56.0.0/16
52.57.0.0/16
52.58.0.0/15
52.60.0.0/16
52.61.0.0/16
52.62.0.0/15
52.64.0.0/17
52.64.128.0/17
52.65.0.0/16
52.66.0.0/16
52.67.0.0/16
52.68.0.0/15
52.70.0.0/15
52.72.0.0/15
52.74.0.0/16
52.75.0.0/16
52.76.0.0/17
52.76.128.0/17
52.77.0.0/16
52.78.0.0/16
52.79.0.0/16
52.80.0.0/16
52.81.0.0/16
52.83.0.0/16
52.86.0.0/15
52.88.0.0/15
52.90.0.0/15
52.95.240.0/24
52.95.241.0/24
52.95.242.0/24
52.95.243.0/24
52.95.244.0/24
52.95.245.0/24
52.95.246.0/24
52.95.247.0/24
52.95.248.0/24
52.95.249.0/24
52.95.250.0/24
52.95.251.0/24
52.95.252.0/24
52.95.253.0/24
52.95.254.0/24
52.95.255.0/28
52.95.255.16/28
52.95.255.32/28
52.95.255.48/28
52.95.255.64/28
52.95.255.80/28
52.95.255.96/28
52.95.255.112/28
52.95.255.128/28
52.95.255.144/28
52.192.0.0/15
52.196.0.0/14
52.200.0.0/13
52.208.0.0/13
52.220.0.0/15
52.222.0.0/17
54.64.0.0/15
54.66.0.0/16
54.67.0.0/16
54.68.0.0/14
54.72.0.0/15
54.74.0.0/15
54.76.0.0/15
54.78.0.0/16
54.79.0.0/16
54.80.0.0/13
54.88.0.0/14
54.92.0.0/17
54.92.128.0/17
54.93.0.0/16
54.94.0.0/16
54.95.0.0/16
54.144.0.0/14
54.148.0.0/15
54.150.0.0/16
54.151.0.0/17
54.151.128.0/17
54.152.0.0/16
54.153.0.0/17
54.153.128.0/17
54.154.0.0/16
54.155.0.0/16
54.156.0.0/14
54.160.0.0/13
54.168.0.0/16
54.169.0.0/16
54.170.0.0/15
54.172.0.0/15
54.174.0.0/15
54.176.0.0/15
54.178.0.0/16
54.179.0.0/16
54.183.0.0/16
54.184.0.0/13
54.193.0.0/16
54.194.0.0/15
54.196.0.0/15
54.198.0.0/16
54.199.0.0/16
54.200.0.0/15
54.202.0.0/15
54.204.0.0/15
54.206.0.0/16
54.207.0.0/16
54.208.0.0/15
54.210.0.0/15
54.212.0.0/15
54.214.0.0/16
54.215.0.0/16
54.216.0.0/15
54.218.0.0/16
54.219.0.0/16
54.220.0.0/16
54.221.0.0/16
54.222.128.0/17
54.223.0.0/16
54.224.0.0/15
54.226.0.0/15
54.228.0.0/16
54.229.0.0/16
54.232.0.0/16
54.233.0.0/18
54.233.64.0/18
54.233.128.0/17
54.234.0.0/15
54.236.0.0/15
54.238.0.0/16
54.241.0.0/16
54.242.0.0/15
54.244.0.0/16
54.245.0.0/16
54.246.0.0/16
54.247.0.0/16
54.248.0.0/15
54.250.0.0/16
54.251.0.0/16
54.252.0.0/16
54.253.0.0/16
54.254.0.0/16
54.255.0.0/16
67.202.0.0/18
72.44.32.0/19
75.101.128.0/17
79.125.0.0/17
96.127.0.0/17
103.4.8.0/22
103.4.12.0/22
107.20.0.0/14
122.248.192.0/18
174.129.0.0/16
175.41.128.0/18
175.41.192.0/18
176.32.64.0/19
176.34.0.0/19
176.34.32.0/19
176.34.64.0/18
176.34.128.0/17
177.71.128.0/17
184.72.0.0/18
184.72.64.0/18
184.72.128.0/17
184.73.0.0/16
184.169.128.0/17
185.48.120.0/22
204.236.128.0/18
204.236.192.0/18
216.182.224.0/20
52.95.110.0/24
205.251.192.0/21
13.32.0.0/15
13.54.63.128/26
13.59.250.0/26
13.113.203.0/24
13.124.199.0/24
13.228.69.0/24
34.195.252.0/24
34.226.14.0/24
35.158.136.0/24
35.162.63.192/26
35.167.191.128/26
52.15.127.128/26
52.46.0.0/18
52.52.191.128/26
52.56.127.0/25
52.57.254.0/24
52.66.194.128/26
52.78.247.128/26
52.84.0.0/15
52.199.127.192/26
52.212.248.0/26
52.220.191.0/26
52.222.128.0/17
54.182.0.0/16
54.192.0.0/16
54.230.0.0/16
54.233.255.128/26
54.239.128.0/18
54.239.192.0/19
54.240.128.0/18
204.246.164.0/22
204.246.168.0/22
204.246.174.0/23
204.246.176.0/20
205.251.192.0/19
205.251.249.0/24
205.251.250.0/23
205.251.252.0/23
205.251.254.0/24
216.137.32.0/19
"""